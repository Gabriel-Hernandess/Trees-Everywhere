{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="{% static 'management/css/accounts.css' %}">

    <!-- Scripts -->
    <script src="{% static 'management/js/accounts.js' %}" defer></script>

    <!-- Font awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
    <div class="container">
        <aside class="sidebar">
            <h2>Admin</h2>
            <a class="active-page" href="{% url 'admin-accounts' %}">Contas <i class="fa-solid fa-users"></i></a>
            <a href="{% url 'admin-users' %}">Usu√°rios <i class="fa-solid fa-circle-user"></i></a>
            <a href="{% url 'admin-trees' %}">Plantas <i class="fa-solid fa-tree"></i></a>
            <button onclick="confirmLogout()">Logout <i class="fa-solid fa-right-to-bracket"></i></button>
        </aside>

        <main class="content">
            <section id="accounts" class="section">
                <div class="accounts-header">
                    <h1>Contas</h1>
                    <button onClick="openForm()">Nova conta</button>
                </div>
                
                <div id="accounts-list">
                    {% for account in accounts %}
                        <div class="account-item">
                            <p>{{ account.name }}</p>

                            {% if account.active %}
                                <p class="status">Ativo <i class="fa-solid fa-circle" style="color: green; margin-left: 10px;"></i></p>
                                <button onclick="toggleAccountStatus('deactivate', {{ account.id }})">Desativar</button>
                            {% else %}
                                <p>Inativo <i class="fa-solid fa-circle" style="color: red; margin-left: 10px;"></i></p>
                                <button onclick="toggleAccountStatus('activate', {{ account.id }})">Ativar</button>
                            {% endif %}
                        </div>
                    {% empty %}
                        <p>Nenhuma conta encontrada.</p>
                    {% endfor %}
                </div>
                
                <div class="overlay">
                    <div class="new-account-form">
                        <h3>Criar nova conta</h3>
                        <input placeholder="Nome" id="new-account-name"/>

                        <button onClick="submitNewAccount()">Criar conta</button>
                        <button onCLick="closeForm()">Cancelar</button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        function openForm(){
            const form = document.querySelector('.overlay');
            form.style.display = 'flex';
        }

        function closeForm(){
            const form = document.querySelector('.overlay');
            form.style.display = 'none';
        }

        function confirmLogout() {
            if (confirm("Tem certeza que deseja sair?")) {
                window.location.href = "/logout/";
            }
        }
    </script>
</body>
</html>